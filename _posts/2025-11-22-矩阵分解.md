---
title: 矩阵分解
date: 2025-11-22 10:00:00 +0800
categories: [数学原理, 矩阵论]
tags: [矩阵分解, 线性代数]
math: true
---

## 1. 矩阵分解基础

### 1.1 核心定义

矩阵分解是将一个矩阵拆分为多个结构更简单、性质更明确的矩阵的运算，主要包含两种基本形式：

- **矩阵的和分解**：将矩阵拆分为多个矩阵的和，形式为：

$$
A = A_1 + A_2 + \dots + A_k
$$

- **矩阵的乘积分解**：将矩阵拆分为多个矩阵的乘积，形式为：

$$
A = A_1 A_2 \dots A_m
$$

后续讨论的满秩分解、QR 分解、奇异值分解均属于**矩阵的乘积分解**。

## 2. 矩阵的满秩分解

满秩分解是将任意非零矩阵拆分为“列满秩矩阵”与“行满秩矩阵”的乘积，是后续复杂分解的基础。

### 2.1 满秩分解的定义

设矩阵$A$是复数域$C$上秩为$r$（$r>0$）的$m \times n$矩阵，记为$A \in C_r^{m \times n}$。若存在：

- 列满秩矩阵$F$：维度为$m \times r$，秩$r(A)=r$；
- 行满秩矩阵$G$：维度为$r \times n$，秩$r(A)=r$；

使得$A = FG$，则称该式为矩阵$A$的**满秩分解**。

需注意：满秩分解不唯一。例如对任意$r$阶可逆方阵$D$，有：

$$
A = FG = FDD^{-1}G = (FD)(D^{-1}G) = F_1 G_1
$$

其中$F_1 = FD$仍为列满秩矩阵，$G_1 = D^{-1}G$仍为行满秩矩阵，因此$A=F_1G_1$也是一种满秩分解。

### 2.2 满秩分解的存在性

**定理 4.3**：任何非零矩阵均存在满秩分解（核心依据：初等行变换不改变矩阵的秩）。

构造性证明步骤（依赖矩阵的初等变换与分块）：

1. 设$A \in C_r^{m \times n}$，存在$m$阶初等矩阵$E_1,E_2,\dots,E_k$，对$A$做初等行变换得：

$$
B = E_k \cdots E_2 E_1 A = \begin{pmatrix} G \\ O \end{pmatrix}
$$

其中$G$是$r \times n$的行满秩矩阵，$O$是$(m-r) \times n$的零矩阵； 2. 令$P = E_k \cdots E_2 E_1$（$P$是可逆矩阵，因初等矩阵可逆，乘积仍可逆），则$A = P^{-1}B$； 3. 对$P^{-1}$做分块：$P^{-1} = (F, S)$，其中$F$是$m \times r$矩阵，$S$是$m \times (m-r)$矩阵； 4. 代入$A = P^{-1}B$得：

$$
A = (F, S) \begin{pmatrix} G \\ O \end{pmatrix} = FG + SO = FG
$$

此时$F$为列满秩矩阵，$G$为行满秩矩阵，即$A=FG$是满秩分解。

### 2.3 满秩分解的求法

#### 2.3.1 构造性证明法（基础方法）

该方法直接基于定理 4.3 的证明过程，步骤与证明一致，但需计算可逆矩阵$P$的逆矩阵$P^{-1}$，实际计算中较麻烦，适合理论推导，不适合大规模矩阵。

#### 2.3.2 初等变换法（常用方法）

无需计算逆矩阵，直接通过初等行变换求分解，步骤如下：

1. 对$A$做初等行变换，将其化为**行最简形矩阵**（获取了$B$矩阵），去掉全为零的$(m-r)$行，得到行满秩矩阵$G$；
2. 观察行最简形$G$中单位矩阵$I_r$（$r$阶单位矩阵）对应的列位置，在原矩阵$A$中取出这些列向量，构成列满秩矩阵$F$；
3. 最终$A=FG$即为满秩分解。

### 2.4 满秩分解的相关性质

**定理 4.4**：设$A \in C_r^{m \times n}$（$r>0$），则：

1. $AA^H$与$A^H A$均为**半正定的 Hermite 矩阵**；
2. 秩的关系：$r(AA^H) = r(A^H A) = r(A) = r$。

#### 2.4.1 性质 1 的证明（依赖 Hermite 矩阵定义与向量范数）

- Hermite 矩阵验证：$(A^H A)^H = A^H (A^H)^H = A^H A$，故$A^H A$是 Hermite 矩阵；同理$AA^H$也是 Hermite 矩阵；
- 半正定性验证：对任意复向量$x \in C^n$，有：

$$
x^H (A^H A) x = (x^H A^H)(A x) = (A x)^H (A x) = \| A x \|_2^2 \geq 0
$$

其中$\| A x \|_2^2$是向量$A x$的 2-范数的平方，恒非负，故$A^H A$半正定；同理$AA^H$半正定。

#### 2.4.2 性质 2 的证明（依赖方程组同解性）

需证明$r(A^H A) = r(A)$（$r(AA^H)=r(A)$同理）：

1. 若$x_0$是$A x = 0$的解，则$A x_0 = 0$，代入得$A^H A x_0 = A^H (A x_0) = 0$，即$x_0$也是$A^H A x = 0$的解；
2. 若$x_0$是$A^H A x = 0$的解，则$A^H A x_0 = 0$，两边左乘$x_0^H$得：

$$
x_0^H (A^H A x_0) = 0 \implies (A x_0)^H (A x_0) = 0 \implies A x_0 = 0
$$

即$x_0$也是$A x = 0$的解； 3. 综上，$A x = 0$与$A^H A x = 0$同解，故基础解系维度相同，由秩与解系的关系$r(A) = n - \text{基础解系维度}$，得$r(A^H A) = r(A)$。

### 2.5 满秩分解的重要推论

#### 2.5.1 推论 4.4

设$A \in C^{m \times n}$，则$A^H A = 0$的充分必要条件是$A = 0$。

- 充分性：若$A = 0$，则$A^H A = 0^H 0 = 0$，显然成立；
- 必要性：若$A^H A = 0$，由定理 4.4 的证明可知$(A x)^H (A x) = 0$对任意$x$成立，故$A x = 0$对任意$x$成立，即$A = 0$。

#### 2.5.2 推论 4.5

设$A \in C^{m \times n}$，则：

1. 若$A$是**列满秩矩阵**（$r = n$），则$A^H A$可逆，且线性方程组$A x = b$有唯一解：

   $$
   x = (A^H A)^{-1} A^H b
   $$

2. 若$A$是**行满秩矩阵**（$r = m$），则$AA^H$可逆。

### 2.6 典型例子（例 4.3）

求矩阵$A = \begin{pmatrix} 1 & 2 & -1 & 1 \\ 2 & 3 & 3 & -2 \\ 3 & 5 & 2 & -1 \\ -1 & -3 & 6 & -5 \end{pmatrix}$的满秩分解。

步骤：

1. 对$A$做初等行变换化为行最简形，去掉零行得$G = \begin{pmatrix} 1 & 0 & 9 & -7 \\ 0 & 1 & -5 & 4 \end{pmatrix}$（行满秩）；
2. 观察$G$中单位矩阵$I_2$（前两列），在$A$中取前两列构成$F = \begin{pmatrix} 1 & 2 \\ 2 & 3 \\ 3 & 5 \\ -1 & -3 \end{pmatrix}$（列满秩）；
3. 最终满秩分解为：

$$
A = FG = \begin{pmatrix} 1 & 2 \\ 2 & 3 \\ 3 & 5 \\ -1 & -3 \end{pmatrix} \begin{pmatrix} 1 & 0 & 9 & -7 \\ 0 & 1 & -5 & 4 \end{pmatrix}
$$

## 3. 矩阵的 QR 分解

QR 分解是将矩阵拆分为“酉/正交矩阵”与“上三角矩阵”的乘积，是数值计算（如求特征值、解线性方程组）的核心工具。

### 3.1 QR 分解的定义

若$n$阶矩阵$A$可分解为：

$$
A = QR
$$

其中：

- $Q$是**酉矩阵**（复数域）或**正交矩阵**（实数域），满足$Q^H Q = I$（$I$为单位矩阵）；
- $R$是**复上三角矩阵**（复数域）或**实上三角矩阵**（实数域），且主对角线元素非零；

则称该式为矩阵$A$的**QR 分解**。

### 3.2 QR 分解的存在条件

**定理 4.6**：若$n$阶方阵$A = (a_{ij})_{n \times n}$是**可逆复矩阵**（或可逆实矩阵），则存在：

- $n$阶酉矩阵（或正交矩阵）$Q$；
- $n$阶复（或实）**正线上三角矩阵**$R$（主对角线元素均为正实数）；

使得$A = QR$，且该分解唯一（当$R$为主对角线元素为正的上三角矩阵时）。

### 3.3 QR 分解的重要推论

#### 3.3.1 推论 4.6（非方阵/降秩矩阵的情况）

设$A$是$n \times r$矩阵（$n > r$），且秩$r(A) = r$，则存在：

- $n$阶酉矩阵$Q$；
- $r$阶复正线上三角矩阵$R$；

使得：

$$
A = Q \begin{pmatrix} R \\ O \end{pmatrix}
$$

其中$O$是$(n - r) \times r$的零矩阵。

#### 3.3.2 推论 4.7（实对称正定矩阵的情况）

设$A$是$n$阶**实对称正定矩阵**，则存在唯一的$n$阶实正线上三角矩阵$R$，使得：

$$
A = R^T R
$$

（该分解也称为“Cholesky 分解”，是 QR 分解的特殊形式）。

### 3.4 QR 分解的求法（Schmidt 正交化法）

核心思路：通过**Schmidt 正交化**将$A$的列向量化为正交向量组，再单位化得$Q$的列向量，最后构造上三角矩阵$R$。

具体步骤（以实可逆矩阵为例）：

1. 对$A$做列分块：$A = (\alpha_1, \alpha_2, \dots, \alpha_n)$，其中$\alpha_1, \alpha_2, \dots, \alpha_n$是$A$的列向量（因$A$可逆，列向量线性无关）；
2. Schmidt 正交化：将线性无关的列向量化为正交向量组$\beta_1, \beta_2, \dots, \beta_n$，公式为：

   $$
   \begin{align}
   \beta_1 &= \alpha_1 \\
   \beta_2 &= \alpha_2 - \frac{(\alpha_2, \beta_1)}{(\beta_1, \beta_1)} \beta_1 \\
   \beta_3 &= \alpha_3 - \frac{(\alpha_3, \beta_1)}{(\beta_1, \beta_1)} \beta_1 - \frac{(\alpha_3, \beta_2)}{(\beta_2, \beta_2)} \beta_2 \\
   &\vdots \\
   \beta_n &= \alpha_n - \sum_{k=1}^{n-1} \frac{(\alpha_n, \beta_k)}{(\beta_k, \beta_k)} \beta_k
   \end{align}
   $$

   其中$(\alpha, \beta)$是向量$\alpha$与$\beta$的内积（实数域中为$\alpha^T \beta$）； 3. 单位化：将正交向量组$\beta_1, \dots, \beta_n$化为标准正交向量组$\gamma_1, \dots, \gamma_n$，公式为：

   $$
   \gamma_i = \frac{1}{\| \beta_i \|} \beta_i \quad (i=1,2,\dots,n)
   $$

   其中$\| \beta_i \| = \sqrt{(\beta_i, \beta_i)}$是$\beta_i$的 2-范数； 4. 构造矩阵$Q$与$R$：

3. $Q = (\gamma_1, \gamma_2, \dots, \gamma_n)$（正交矩阵）；
4. $R$是上三角矩阵，主对角线元素为$\| \beta_1 \|, \| \beta_2 \|, \dots, \| \beta_n \|$，非主对角线元素为$\frac{(\alpha_i, \beta_j)}{(\beta_j, \beta_j)}$（$j < i$）；

5. 最终得$A = QR$。

### 3.5 典型例子（例 4.5）

用 Schmidt 正交化法求$A = \begin{pmatrix} 3 & 14 & 9 \\ 6 & 43 & 3 \\ 6 & 22 & 15 \end{pmatrix}$的 QR 分解。

步骤：

1. 列分块$A = (\alpha_1, \alpha_2, \alpha_3)$，其中$\alpha_1 = (3,6,6)^T$，$\alpha_2 = (14,43,22)^T$，$\alpha_3 = (9,3,15)^T$；
2. Schmidt 正交化：

   $$
   \begin{align}
   \beta_1 &= \alpha_1 = (3,6,6)^T \\
   \beta_2 &= \alpha_2 - \frac{(\alpha_2, \beta_1)}{(\beta_1, \beta_1)} \beta_1 = (14,43,22)^T - \frac{16}{3}(3,6,6)^T = (-2,11,-10)^T \\
   \beta_3 &= \alpha_3 - \frac{(\alpha_3, \beta_1)}{(\beta_1, \beta_1)} \beta_1 - \frac{(\alpha_3, \beta_2)}{(\beta_2, \beta_2)} \beta_2 = (14,-2,-5)^T
   \end{align}
   $$

3. 单位化：

   $$
   \gamma_1 = \frac{1}{\| \beta_1 \|} \beta_1 = \frac{1}{3}(1,2,2)^T, \quad \gamma_2 = \frac{1}{15}(-2,11,-10)^T, \quad \gamma_3 = \frac{1}{15}(14,-2,-5)^T
   $$

4. 构造$Q$与$R$：

   $$
   Q = (\gamma_1, \gamma_2, \gamma_3) = \frac{1}{15} \begin{pmatrix} 5 & -2 & 14 \\ 10 & 11 & -2 \\ 10 & -10 & -5 \end{pmatrix}
   $$

   $$
   R = \begin{pmatrix} \| \beta_1 \| & \frac{(\alpha_2, \beta_1)}{\| \beta_1 \|} & \frac{(\alpha_3, \beta_1)}{\| \beta_1 \|} \\ 0 & \| \beta_2 \| & \frac{(\alpha_3, \beta_2)}{\| \beta_2 \|} \\ 0 & 0 & \| \beta_3 \| \end{pmatrix} = \begin{pmatrix} 9 & 48 & 15 \\ 0 & 15 & -9 \\ 0 & 0 & 3 \end{pmatrix}
   $$

5. 最终 QR 分解：

   $$
   A = QR = \frac{1}{15} \begin{pmatrix} 5 & -2 & 14 \\ 10 & 11 & -2 \\ 10 & -10 & -5 \end{pmatrix} \begin{pmatrix} 9 & 48 & 15 \\ 0 & 15 & -9 \\ 0 & 0 & 3 \end{pmatrix}
   $$

## 4. 矩阵的奇异值分解

奇异值分解是最通用的矩阵分解（适用于任意矩阵），在最小二乘法、矩阵广义逆、数据降维中起关键作用。

### 4.1 奇异值的定义

设$m \times n$矩阵$A$的秩为$r$（$r \geq 1$）：

1. 因$A^H A$是$n$阶**半正定 Hermite 矩阵**（由满秩分解的定理 4.4 推导），其特征值均为非负实数，记为：

   $$
   \lambda_1 \geq \lambda_2 \geq \dots \geq \lambda_r > \lambda_{r+1} = \dots = \lambda_n = 0
   $$

2. 定义矩阵$A$的**奇异值**为特征值的平方根：

   $$
   \sigma_i = \sqrt{\lambda_i} \quad (i=1,2,\dots,n)
   $$

   其中$\sigma_1 \geq \sigma_2 \geq \dots \geq \sigma_r > 0$称为“正奇异值”，$\sigma_{r+1} = \dots = \sigma_n = 0$称为“零奇异值”。

### 4.2 奇异值分解的核心定理

**定理 4.9**：设$A \in C_r^{m \times n}$（$r \geq 1$），$\sigma_1 \geq \sigma_2 \geq \dots \geq \sigma_r > 0$是$A$的正奇异值，则存在：

- $m$阶酉矩阵$U \in C^{m \times m}$；
- $n$阶酉矩阵$V \in C^{n \times n}$；
- $m \times n$对角矩阵$\Sigma = \text{diag}(\sigma_1, \sigma_2, \dots, \sigma_r, 0, \dots, 0)$（仅前$r$个对角元为正奇异值，其余为 0）；

使得：

$$
U^H A V = \Sigma \quad \text{或} \quad A = U \Sigma V^H
$$

该式称为矩阵$A$的**奇异值分解**。

### 4.3 奇异值分解的补充定理

**定理 4.10**：设$A$是$n$阶**非奇异矩阵**（$r = n$），其奇异值分解为$A = U \Sigma V^H$。若将$U = (u_1, u_2, \dots, u_n)$、$V = (v_1, v_2, \dots, v_n)$（列分块），则：

$$
A = \sum_{i=1}^n \sigma_i u_i v_i^H
$$

（该式将$A$表示为“秩 1 矩阵的加权和”，权重为奇异值，是数据降维的理论基础）。

### 4.4 关键结论：U 与 V 的列向量来源

奇异值分解中，酉矩阵$U$和$V$的列向量分别对应特定矩阵的特征向量，具体为：

- $V$的列向量是$A^H A$的特征向量；
- $U$的列向量是$AA^H$的特征向量。

推导过程（依赖酉矩阵的性质$V^H V = I$、$U^H U = I$）：

1. 由奇异值分解$A = U \Sigma V^H$，得$A^H A = V \Sigma^H U^H U \Sigma V^H = V \Sigma^2 V^H$（因$U^H U = I$，$\Sigma^H = \Sigma$，故$\Sigma^H \Sigma = \Sigma^2$）；
2. 上式可改写为$V^H (A^H A) V = \Sigma^2$，即$A^H A V = V \Sigma^2$，说明$V$的列向量是$A^H A$的特征向量，特征值为$\sigma_1^2, \sigma_2^2, \dots, \sigma_n^2$；
3. 同理，$AA^H = U \Sigma V^H V \Sigma^H U^H = U \Sigma^2 U^H$，改写为$U^H (AA^H) U = \Sigma^2$，说明$U$的列向量是$AA^H$的特征向量，特征值同样为$\sigma_1^2, \sigma_2^2, \dots, \sigma_m^2$。

### 4.5 重要注记

1. 酉矩阵$U$不唯一：同一特征值对应的特征向量可相差一个符号（或线性组合），导致$U$的列向量不唯一；
2. 对角矩阵$\Sigma$的排序可变化：正奇异值的顺序可调整（如$\sigma_2 \geq \sigma_1 \geq \dots$），但需同步调整$U$和$V$的列向量顺序，保持“奇异值-特征向量”的对应关系；
3. $U$和$V$的列向量扩充：$V$中零奇异值对应的列向量（即$A^H A$的零特征值特征向量）需从$A^H A$的特征空间中标准正交化扩充；$U$中零奇异值对应的列向量同理从$AA^H$的特征空间中扩充。

### 4.6 典型例子（例 4.8）

求矩阵$A = \begin{pmatrix} 1 & 0 & 1 \\ 0 & 1 & 1 \\ 0 & 0 & 0 \end{pmatrix}$的奇异值分解。

步骤：

1. 计算$A^H A$及其特征值、特征向量：

   $$
   A^H A = \begin{pmatrix} 1 & 0 & 1 \\ 0 & 1 & 1 \\ 1 & 1 & 2 \end{pmatrix}
   $$

   特征方程：$\det(\lambda I - A^H A) = (\lambda - 3)(\lambda - 1)\lambda = 0$，得特征值$\lambda_1 = 3$，$\lambda_2 = 1$，$\lambda_3 = 0$； 2. 计算奇异值：$\sigma_1 = \sqrt{3}$，$\sigma_2 = 1$，$\sigma_3 = 0$（正奇异值为$\sigma_1, \sigma_2$）； 3. 求$A^H A$的特征向量并单位化：

   - $\lambda_1 = 3$的特征向量：$\alpha_1 = (1,1,2)^T$，单位化得$v_1 = \frac{1}{\sqrt{6}}(1,1,2)^T$；
   - $\lambda_2 = 1$的特征向量：$\alpha_2 = (1,-1,0)^T$，单位化得$v_2 = \frac{1}{\sqrt{2}}(1,-1,0)^T$；
   - $\lambda_3 = 0$的特征向量：$\alpha_3 = (1,1,-1)^T$，单位化得$v_3 = \frac{1}{\sqrt{3}}(1,1,-1)^T$；

2. 构造酉矩阵$V$：$V = (v_1, v_2, v_3) = \begin{pmatrix} \frac{1}{\sqrt{6}} & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} \\ \frac{1}{\sqrt{6}} & -\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} \\ \frac{2}{\sqrt{6}} & 0 & -\frac{1}{\sqrt{3}} \end{pmatrix}$；
3. 构造酉矩阵$U$：

   - 取$V_1 = (v_1, v_2)$（对应正奇异值的列向量），计算$U_1 = A V_1 \Sigma^{-1}$（$\Sigma = \text{diag}(\sqrt{3},1)$）：

   $$
   U_1 = A V_1 \Sigma^{-1} = \begin{pmatrix} 1 & 0 & 1 \\ 0 & 1 & 1 \\ 0 & 0 & 0 \end{pmatrix} \begin{pmatrix} \frac{1}{\sqrt{6}} & \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{6}} & -\frac{1}{\sqrt{2}} \\ \frac{2}{\sqrt{6}} & 0 \end{pmatrix} \begin{pmatrix} \frac{1}{\sqrt{3}} & 0 \\ 0 & 1 \end{pmatrix} = \begin{pmatrix} \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} \\ 0 & 0 \end{pmatrix}
   $$

   - 扩充$U_1$为$3$阶酉矩阵$U$，取$U_2 = (0,0,1)^T$（与$U_1$的列向量正交），故$U = (U_1, U_2) = \begin{pmatrix} \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0 \\ \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} & 0 \\ 0 & 0 & 1 \end{pmatrix}$；

4. 构造$\Sigma$：$\Sigma = \begin{pmatrix} \sqrt{3} & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 0 \end{pmatrix}$；
5. 最终奇异值分解：

   $$
   A = U \Sigma V^H = \begin{pmatrix} \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0 \\ \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} & 0 \\ 0 & 0 & 1 \end{pmatrix} \begin{pmatrix} \sqrt{3} & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 0 \end{pmatrix} \begin{pmatrix} \frac{1}{\sqrt{6}} & \frac{1}{\sqrt{6}} & \frac{2}{\sqrt{6}} \\ \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} & 0 \\ \frac{1}{\sqrt{3}} & \frac{1}{\sqrt{3}} & -\frac{1}{\sqrt{3}} \end{pmatrix}
   $$
