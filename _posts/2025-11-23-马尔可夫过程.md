---
title: 第五章 马尔可夫过程
date: 2025-11-23 10:00:00 +0800
categories: [数学原理, 随机过程]
tags: [马尔可夫过程, 数学表达]
math: true
description: 马尔可夫过程是一种重要的随机过程，它在数学表达上与马尔可夫链有显著区别。
---

## 1. 马尔可夫过程基础概念

### 1.1 马尔可夫过程的定义

#### 1.1.1 核心性质：无后效性

**马尔可夫过程**的本质是“未来状态只依赖于当前状态，与过去状态无关”，这一性质称为**无后效性**（或马尔可夫性）。通俗来说，只要知道过程当前处于哪个状态，就能预测未来的状态概率，无需追溯更早的状态。

#### 1.1.2 数学表达

设连续参数随机过程$\{X(t), t \geq 0\}$的状态空间为$S=\{1,2,\cdots\}$，若对任意满足$0 \leq t_1 < t_2 < \cdots < t_n < t_{n+1}$的时间点，以及任意状态$i_1,i_2,\cdots,i_{n+1} \in S$，都有：

$$
\begin{align}
P(X(t_{n+1})&=i_{n+1} \mid X(t_1)=i_1,\cdots,X(t_n)=i_n) \\
&= P(X(t_{n+1})=i_{n+1} \mid X(t_n)=i_n)
\end{align}
$$

则称$\{X(t), t \geq 0\}$为**连续参数马尔可夫过程**。

### 1.2 离散与连续马尔可夫过程的联系

连续参数马尔可夫过程与离散参数马尔可夫链（简称“离散马氏链”）通过“抽样”相互关联：

- 若$\{X(t), t \geq 0\}$是连续马尔可夫过程，对任意一串时间点$\{t_n\} \subset [0,\infty)$（满足$0 \leq t_1 < t_2 < \cdots$），抽样得到的$\{X(t_n), n=1,2,\cdots\}$一定是离散马氏链；
- 反之，若对任意抽样时间$\{t_n\}$，$\{X(t_n)\}$都是离散马氏链，则$\{X(t), t \geq 0\}$是连续马尔可夫过程。

### 1.3 状态停留时间的分布

#### 1.3.1 无记忆性与指数分布

连续马尔可夫过程在某个状态$i$停留的时间（记为$\tau_i$）具有**无记忆性**：即“已经停留了$s$时间后，再停留至少$t$时间”的概率，等于“从开始停留至少$t$时间”的概率，数学表达为：

$$
P(\tau_i > s+t \mid \tau_i > s) = P(\tau_i > t)
$$

而具有无记忆性的连续分布只有**指数分布**，因此$\tau_i \sim e(\nu_i)$（参数为$\nu_i$的指数分布），其期望为$E\tau_i = \frac{1}{\nu_i}$。

#### 1.3.2 特殊状态类型

根据$\nu_i$的取值，状态$i$分为两类：

- **瞬时状态**：$\nu_i = \infty$，过程在该状态停留的时间几乎为 0；
- **吸收状态**：$\nu_i = 0$，过程一旦进入该状态，就永远不会离开（停留时间无限长）。
  实际应用中，通常假设$0 \leq \nu_i < \infty$，即过程在状态间转移时，会在每个状态停留有限时间。

## 2. 转移矩阵与 Chapman-Kolmogorov 方程

### 2.1 转移概率与齐次性

#### 2.1.1 转移概率的定义

描述连续马尔可夫过程从状态$i$转移到状态$j$的概率称为**转移概率**，记为：

$$
p(s,i;s+t,j) = P(X(s+t)=j \mid X(s)=i)
$$

它表示“$s$时刻在状态$i$的条件下，$s+t$时刻转移到状态$j$”的概率。

#### 2.1.2 齐次性假设

若转移概率$p(s,i;s+t,j)$与初始时间$s$无关（只与时间间隔$t$和状态$i,j$有关），则称过程具有**齐次性**，此时转移概率可简化为：

$$
p_{ij}^{(t)} = P(X(s+t)=j \mid X(s)=i)
$$

### 2.2 转移矩阵的性质

由转移概率$p_{ij}^{(t)}$构成的矩阵$\boldsymbol{P}^{(t)} = (p_{ij}^{(t)})$称为**转移矩阵**，它满足两个核心性质：

1. 非负性：对任意$i,j \in S$，$p_{ij}^{(t)} \geq 0$（概率非负）；
2. 行和为 1：对任意$i \in S$，$\sum_{j \in S} p_{ij}^{(t)} = 1$（从状态$i$转移到所有可能状态的概率和为 1）。

### 2.3 Chapman-Kolmogorov 方程

#### 2.3.1 方程形式

对于任意$s>0,t>0$，转移概率满足**Chapman-Kolmogorov 方程**（简称 C-K 方程），其本质是“多步转移可分解为两步转移的叠加”：

$$
p_{ij}^{(s+t)} = \sum_{r \in S} p_{ir}^{(s)} \cdot p_{rj}^{(t)}
$$

用矩阵形式表示更简洁：

$$
\boldsymbol{P}^{(s+t)} = \boldsymbol{P}^{(s)} \cdot \boldsymbol{P}^{(t)}
$$

#### 2.3.2 物理意义

C-K 方程说明：“从$i$经过$s+t$时间到$j$”的概率，等于“从$i$经过$s$时间到中间状态$r$，再从$r$经过$t$时间到$j$”的概率之和（对所有中间状态$r$求和）。

### 2.4 正则性条件

为保证过程“不会刚进入一个状态就立即离开”，需要**正则性条件**：当时间间隔$t$趋近于 0+时，转移概率满足：

$$
\lim_{t \to 0+} p_{ij}^{(t)} = \delta_{ij} = \begin{cases}
1 & i=j \\
0 & i \neq j
\end{cases}
$$

其中$\delta_{ij}$是克罗内克函数。矩阵形式为$\lim_{t \to 0+} \boldsymbol{P}^{(t)} = \boldsymbol{I}$（$\boldsymbol{I}$为单位矩阵），满足正则性的马尔可夫过程称为**正则马尔可夫过程**。

### 2.5 绝对概率

#### 2.5.1 定义

过程在$t$时刻处于状态$j$的无条件概率称为**绝对概率**（或状态概率），记为：

$$
p_j(t) = P(X(t)=j) \quad (j \in S)
$$

特别地，$t=0$时的绝对概率$p_j(0) = P(X(0)=j)$称为**初始概率**，记为$p_j$。

#### 2.5.2 基本性质

绝对概率满足：

1. 非负性：$p_j(t) \geq 0$（概率非负）；
2. 归一性：$\sum_{j \in S} p_j(t) = 1$（所有状态的概率和为 1）；
3. 与转移概率的关系：$p_j(t) = \sum_{i \in S} p_i \cdot p_{ij}^{(t)}$（初始概率与转移概率的加权和）。

## 3. Q 矩阵（速率矩阵）

### 3.1 Q 矩阵的定义

#### 3.1.1 从转移矩阵到 Q 矩阵

Q 矩阵是转移矩阵在$t=0$处的**右导数**，即通过“微小时间间隔内的转移概率变化率”定义。对任意状态$i,j$，Q 矩阵的元素$q_{ij}$为：

$$
q_{ij} = \lim_{h \to 0+} \frac{p_{ij}^{(h)} - \delta_{ij}}{h}
$$

由$q_{ij}$构成的矩阵$\boldsymbol{Q} = (q_{ij})$称为**速率矩阵**（或生成矩阵）。

#### 3.1.2 物理意义

$q_{ij}$描述“微小时间内的转移速率”：

- 当$i \neq j$时，$q_{ij}$是“从$i$转移到$j$”的速率（值越大，转移越容易）；
- 当$i = j$时，$q_{ii} = -\sum_{j \neq i} q_{ij}$，是“从$i$离开”的总速率的负值（保证每行和为 0）。

### 3.2 Q 矩阵的核心性质

1. 非负性（非对角元）：对任意$i \neq j$，$q_{ij} \geq 0$（转移速率非负）；
2. 对角元性质：对任意$i$，$-\infty \leq q_{ii} \leq 0$（离开速率的负值）；
3. 行和为 0：对任意$i$，$\sum_{j \in S} q_{ij} = 0$（离开总速率等于进入总速率）。

### 3.3 Q 矩阵的分类

根据元素的取值范围，Q 矩阵分为两类：

1. **保守（稳定）Q 矩阵**：若对任意$i$，$\sum_{j \neq i} q_{ij} = -q_{ii} < \infty$（离开总速率有限）；
2. **有界 Q 矩阵**：若所有状态的离开速率有上界，即$\sup_{i \in S} (-q_{ii}) < \infty$。

### 3.4 Q 矩阵问题

#### 3.4.1 核心问题

“Q 矩阵问题”是指两个相互关联的问题：

1. 判定：给定一个方阵，是否为某个马尔可夫过程的 Q 矩阵？
2. 求解：若已知 Q 矩阵，如何求对应的转移矩阵$\boldsymbol{P}^{(t)}$？

#### 3.4.2 有限状态的结论

对于**有限状态**（$S=\{1,2,\cdots,k\}$）的情况，结论简单且唯一：

- 若$\boldsymbol{Q}$是 Q 矩阵，则存在唯一的转移矩阵族$\{\boldsymbol{P}^{(t)}, t \geq 0\}$，满足$\boldsymbol{P}'(0+) = \boldsymbol{Q}$；
- 转移矩阵可表示为$\boldsymbol{P}^{(t)} = e^{t\boldsymbol{Q}}$（矩阵指数），展开式为：

$$
\boldsymbol{P}^{(t)} = e^{t\boldsymbol{Q}} = \sum_{n=0}^{\infty} \frac{(t\boldsymbol{Q})^n}{n!} = \boldsymbol{I} + t\boldsymbol{Q} + \frac{t^2\boldsymbol{Q}^2}{2!} + \cdots
$$

## 4. 柯尔莫果洛夫方程

### 4.1 方程的前提条件

柯尔莫果洛夫方程（简称“柯氏方程”）适用于**有限齐次正则马尔可夫过程**，核心前提是：

1. 状态空间有限（$S=\{1,2,\cdots,k\}$）；
2. 过程满足齐次性和正则性；
3. Q 矩阵存在（转移矩阵在$t=0$处可导）。

### 4.2 柯氏向前方程

#### 4.2.1 方程形式

向前方程描述“转移概率对终止时间的导数”，数学表达为：

$$
\frac{d p_{ij}^{(t)}}{dt} = \sum_{r \in S} p_{ir}^{(t)} \cdot q_{rj}
$$

矩阵形式更简洁：

$$
\frac{d \boldsymbol{P}^{(t)}}{dt} = \boldsymbol{P}^{(t)} \cdot \boldsymbol{Q}
$$

#### 4.2.2 物理意义

“从$i$到$j$的转移概率变化率”，等于“从$i$到中间状态$r$的当前转移概率”乘以“从$r$到$j$的转移速率”之和（重点关注“中间状态$r$到$j$”的速率，即“向前看”）。

### 4.3 柯氏向后方程

#### 4.3.1 方程形式

向后方程描述“转移概率对起始时间的导数”，数学表达为：

$$
\frac{d p_{ij}^{(t)}}{dt} = \sum_{r \in S} q_{ir} \cdot p_{rj}^{(t)}
$$

矩阵形式为：

$$
\frac{d \boldsymbol{P}^{(t)}}{dt} = \boldsymbol{Q} \cdot \boldsymbol{P}^{(t)}
$$

#### 4.3.2 物理意义

“从$i$到$j$的转移概率变化率”，等于“从$i$到中间状态$r$的转移速率”乘以“从$r$到$j$的当前转移概率”之和（重点关注“$i$到中间状态$r$”的速率，即“向后看”）。

### 4.4 方程的解

对于有限状态情况，柯氏向前/向后方程的解与 Q 矩阵的矩阵指数一致，即：

$$
\boldsymbol{P}^{(t)} = e^{t\boldsymbol{Q}}
$$

这一解满足初始条件$\boldsymbol{P}^{(0)} = \boldsymbol{I}$（$t=0$时，转移矩阵为单位矩阵，即“状态不变”）。

## 5. 平稳分布与遍历性

### 5.1 平稳分布的定义

#### 5.1.1 核心概念

若一个概率分布$\{\pi_j, j \in S\}$满足：

1. 归一性：$\sum_{j \in S} \pi_j = 1$；
2. 不变性：对任意$t \geq 0$，$\pi_j = \sum_{i \in S} \pi_i \cdot p_{ij}^{(t)}$；
   则称$\{\pi_j\}$为马尔可夫过程的**平稳分布**。

#### 5.1.2 与 Q 矩阵的关系

由不变性$\pi_j = \sum_{i \in S} \pi_i p_{ij}^{(t)}$对$t$求导（$t=0$时），结合 Q 矩阵的定义，可推出平稳分布满足：

$$
\sum_{i \in S} \pi_i q_{ij} = 0 \quad (j \in S)
$$

用矩阵形式表示为$\boldsymbol{\Pi} \cdot \boldsymbol{Q} = \boldsymbol{0}$（$\boldsymbol{\Pi} = (\pi_1,\pi_2,\cdots)$为平稳分布行向量）。

### 5.2 遍历性定理

#### 5.2.1 遍历性的定义

若马尔可夫过程的转移概率$p_{ij}^{(t)}$满足：当$t \to \infty$时，$p_{ij}^{(t)}$趋近于一个与初始状态$i$无关的常数$v_j$，则称过程具有**遍历性**，$v_j$称为**极限分布**。

#### 5.2.2 有限状态的遍历条件

对于有限齐次马尔可夫过程，若存在某个$t_0 > 0$，使得对所有$i,j \in S$，都有$p_{ij}^{(t_0)} > 0$（即“任意状态间都能在$t_0$时间内转移”），则过程一定具有遍历性，且：

$$
\lim_{t \to \infty} p_{ij}^{(t)} = v_j \quad (i,j \in S)
$$

### 5.3 平稳分布与极限分布的关系

对于具有遍历性的有限齐次马尔可夫过程，**平稳分布唯一**，且平稳分布等于极限分布，即：

$$
\pi_j = v_j \quad (j \in S)
$$

这意味着：当过程运行足够长时间后，状态概率会稳定在平稳分布，不再随时间变化。

## 6. 典型例子分析

### 6.1 两状态马尔可夫过程

#### 6.1.1 问题条件

设$\{X(t), t \geq 0\}$是齐次马尔可夫过程，状态空间$S=\{0,1\}$，微小时间$h$内的转移概率为：

- $p_{01}^{(h)} = \lambda h + o(h)$（从 0 到 1 的转移概率，$\lambda$为转移速率）；
- $p_{10}^{(h)} = \mu h + o(h)$（从 1 到 0 的转移概率，$\mu$为转移速率）；
  其中$o(h)$是$h$的高阶无穷小（$h \to 0$时，$o(h)/h \to 0$）。

#### 6.1.2 步骤 1：求 Q 矩阵

根据 Q 矩阵的定义，计算各元素：

- $q_{00} = \lim_{h \to 0} \frac{p_{00}^{(h)} - 1}{h} = \lim_{h \to 0} \frac{(1 - p_{01}^{(h)}) - 1}{h} = -\lambda$；
- $q_{01} = \lim_{h \to 0} \frac{p_{01}^{(h)}}{h} = \lambda$；
- $q_{10} = \lim_{h \to 0} \frac{p_{10}^{(h)}}{h} = \mu$；
- $q_{11} = \lim_{h \to 0} \frac{p_{11}^{(h)} - 1}{h} = \lim_{h \to 0} \frac{(1 - p_{10}^{(h)}) - 1}{h} = -\mu$；
  因此 Q 矩阵为：

$$
\boldsymbol{Q} = \begin{pmatrix} -\lambda & \lambda \\ \mu & -\mu \end{pmatrix}
$$

#### 6.1.3 步骤 2：求转移矩阵$\boldsymbol{P}^{(t)}$

利用柯氏向后方程，结合$p_{01}^{(t)} = 1 - p_{00}^{(t)}$（行和为 1），可简化为单变量微分方程：

$$
\frac{d p_{00}^{(t)}}{dt} = -(\lambda + \mu) p_{00}^{(t)} + \mu
$$

初始条件为$p_{00}^{(0)} = 1$（$t=0$时，从 0 到 0 的概率为 1）。解此线性微分方程：

1. 求齐次解：$p_{00}^{(t)} = C e^{-(\lambda + \mu)t}$（$C$为常数）；
2. 求特解：设$p_{00}^* = \frac{\mu}{\lambda + \mu}$（代入方程验证满足）；
3. 通解：$p_{00}^{(t)} = C e^{-(\lambda + \mu)t} + \frac{\mu}{\lambda + \mu}$；
4. 代入初始条件$t=0$，得$C = \frac{\lambda}{\lambda + \mu}$，最终：

$$
p_{00}^{(t)} = \frac{\lambda}{\lambda + \mu} e^{-(\lambda + \mu)t} + \frac{\mu}{\lambda + \mu}
$$

同理可求其他转移概率：

$$
\begin{align}
p_{01}^{(t)} &= 1 - p_{00}^{(t)} = \frac{\lambda}{\lambda + \mu} (1 - e^{-(\lambda + \mu)t}) \\
p_{10}^{(t)} &= \frac{\mu}{\lambda + \mu} (1 - e^{-(\lambda + \mu)t}) \\
p_{11}^{(t)} &= \frac{\mu}{\lambda + \mu} e^{-(\lambda + \mu)t} + \frac{\lambda}{\lambda + \mu}
\end{align}
$$

#### 6.1.4 步骤 3：求平稳分布

利用$\boldsymbol{\Pi Q} = \boldsymbol{0}$和$\pi_0 + \pi_1 = 1$：

1. 由$\pi_0 q_{00} + \pi_1 q_{10} = 0$，得$-\lambda \pi_0 + \mu \pi_1 = 0$；
2. 结合$\pi_0 + \pi_1 = 1$，解得：

$$
\pi_0 = \frac{\mu}{\lambda + \mu}, \quad \pi_1 = \frac{\lambda}{\lambda + \mu}
$$

这也是极限分布（因过程满足遍历条件）。

### 6.2 双通道系统（应用案例）

#### 6.2.1 问题背景

两个独立通道，每个通道的“正常工作时间”服从参数$\lambda$的指数分布，“修理时间”服从参数$\mu$的指数分布；$t=0$时两通道均正常工作，$X(t)$表示$t$时刻正常工作的通道数（状态空间$S=\{0,1,2\}$）。

#### 6.2.2 核心结果

1. Q 矩阵：根据微小时间内的转移速率，推导得：

   $$
   \boldsymbol{Q} = \begin{pmatrix} -2\mu & 2\mu & 0 \\ \lambda & -(\lambda + \mu) & \mu \\ 0 & 2\lambda & -2\lambda \end{pmatrix}
   $$

2. 关键概率：两通道在$t$时刻均正常工作的概率（即$p_{22}^{(t)}$的极限情况）为：

   $$
   P(X(t)=2) = e^{-2\lambda t}
   $$

（因两通道独立，正常工作时间的联合分布为参数$2\lambda$的指数分布）。

## 7. 生灭过程（特殊马尔可夫过程）

### 7.1 生灭过程的定义

#### 7.1.1 核心特征

生灭过程是状态仅在“相邻整数”间转移的马尔可夫过程，状态空间通常为$S=\{0,1,2,\cdots,k\}$（有限）或$S=\{0,1,2,\cdots\}$（无限），状态转移仅三种可能：

1. **生**：$i \to i+1$（如生物种群增加 1 个个体），转移速率为$\lambda_i$（$i \geq 0$，$\lambda_k=0$若有限）；
2. **灭**：$i \to i-1$（如生物种群减少 1 个个体），转移速率为$\mu_i$（$i \geq 1$，$\mu_0=0$）；
3. **不变**：$i \to i$，停留速率为$-(\lambda_i + \mu_i)$。

#### 7.1.2 特殊类型

- **纯生过程**：若$\mu_i = 0$（无“灭”的可能），如泊松过程；
- **纯灭过程**：若$\lambda_i = 0$（无“生”的可能），如设备故障后的修理过程。

### 7.2 生灭过程的 Q 矩阵

有限状态生灭过程（$S=\{0,1,\cdots,k\}$）的 Q 矩阵结构为：

$$
\boldsymbol{Q} = \begin{pmatrix}
-\lambda_0 & \lambda_0 & 0 & \cdots & 0 & 0 & 0 \\
\mu_1 & -(\lambda_1 + \mu_1) & \lambda_1 & \cdots & 0 & 0 & 0 \\
0 & \mu_2 & -(\lambda_2 + \mu_2) & \cdots & 0 & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\
0 & 0 & 0 &  \cdots & -(\lambda_{k-1}+\mu_{k-1}) & \lambda_{k-2} & 0 \\
0 & 0 &  0 &  \cdots & \mu_{k-1} & -(\lambda_{k-1}+\mu_{k-1}) & \lambda_{k-1} \\
0 & 0 & 0 & \cdots &   0 &  \mu_k & -\mu_k
\end{pmatrix}
$$

特点：仅对角线、上对角线（生速率$\lambda_i$）、下对角线（灭速率$\mu_i$）有非零元素。

### 7.3 生灭过程的平稳分布

#### 7.3.1 平稳分布方程组

有限状态生灭过程满足遍历性，平稳分布$\{\pi_j\}$满足：

$$
\begin{cases}
-\lambda_0 \pi_0 + \mu_1 \pi_1 = 0 \quad (j=0) \\
-(\lambda_j + \mu_j) \pi_j + \lambda_{j-1} \pi_{j-1} + \mu_{j+1} \pi_{j+1} = 0 \quad (1 \leq j \leq k-1) \\
-\mu_k \pi_k + \lambda_{k-1} \pi_{k-1} = 0 \quad (j=k) \\
\sum_{j=0}^k \pi_j = 1
\end{cases}
$$

#### 7.3.2 通解推导

从$j=0$的方程开始，逐步递推：

1. 由$-\lambda_0 \pi_0 + \mu_1 \pi_1 = 0$，得$\pi_1 = \frac{\lambda_0}{\mu_1} \pi_0$；
2. 由$j=1$的方程，得$\pi_2 = \frac{\lambda_1}{\mu_2} \pi_1 = \frac{\lambda_0 \lambda_1}{\mu_1 \mu_2} \pi_0$；
3. 归纳得任意$j$的平稳分布：

   $$
   \pi_j = \frac{\lambda_0 \lambda_1 \cdots \lambda_{j-1}}{\mu_1 \mu_2 \cdots \mu_j} \pi_0 \quad (j \geq 1)
   $$

4. 代入归一性条件$\sum_{j=0}^k \pi_j = 1$，解得$\pi_0$：

$$
\pi_0 = \left( 1 + \sum_{j=1}^k \frac{\lambda_0 \lambda_1 \cdots \lambda_{j-1}}{\mu_1 \mu_2 \cdots \mu_j} \right)^{-1}
$$

#### 7.3.3 对称情况（$\lambda_i \equiv \lambda$，$\mu_i \equiv \mu$）

若所有生速率相等（$\lambda_i = \lambda$）、所有灭速率相等（$\mu_i = \mu$），则平稳分布简化为：

$$
\pi_j = \left( \frac{\lambda}{\mu} \right)^j \pi_0 \quad (j \geq 1)
$$

代入归一性条件，得：

$$
\pi_0 = \left( 1 + \sum_{j=1}^k \left( \frac{\lambda}{\mu} \right)^j \right)^{-1} = \frac{1 - \rho}{1 - \rho^{k+1}} \quad (\rho = \frac{\lambda}{\mu})
$$

$$
\pi_j = \frac{(1 - \rho) \rho^j}{1 - \rho^{k+1}} \quad (0 \leq j \leq k)
$$
