---
title: 第二章 线性规划问题的求解
date: 2025-11-3 10:00:00 +0800
categories: [数学原理, 最优化方法]
tags: [线性规划, 标准型, 基本解, 基本可行解, 退化与非退化, 图解法, 单纯形法]
math: true
description: 线性规划问题的求解，包括标准型、基本解、基本可行解、退化与非退化、图解法、单纯形法。
---

## 线性规划问题的求解

### 标准型

$$
\begin{align}
\min(\max) \ \ & c^T x \\
\text{s.t.} \ \ & A x = b \\
\quad & x \geq 0
\end{align}
$$

### 基本解

取矩阵-标准型$LP$，设一个$A$为一个**$n$列**的矩阵，其中取定**$m$列**为基矩阵$B$，剩下$n-m$列为非基矩阵$N$，则用数学表示为：

$$
A=(B \  N)
$$

这样约束等式条件为：

$$
(B \  N)(x_B \  x_N)^T=b \\
\rightarrow Bx_B+Nx_N = b
$$

若$B$**非奇异**，得到：

$$
x_B=B^{-1}b-B^{-1}Nx_N
$$

取$x_N = 0$，得到**基本解**：

$$
x =
\begin{pmatrix}
B^{-1}b \\
0
\end{pmatrix}
$$

> [!CAUTION]
>
> 此处，$B$矩阵需要满足非奇异，即行列式不为 0，即满秩。如果$B$矩阵奇异，那么需要使$B$矩阵先满足奇异条件才行。

### 基本可行解

满足：

1. 是基本解，也就是说可以通过上面的方法求取，继承了基本解的所有特性，包括：
   - $B$矩阵奇异
2. 非负，即$x_B \geq 0$

这样的$x$称之为基本可行解。

### 退化与非退化

上面说到基本可行解的解法，此时基矩阵$B$的列数为$m$：

- 如果基本可行解中**非零分量**的个数=m，那么称之为非退化
- 否则，称之为退化

### 图解法

- 适用范围：适用于 两个 或 三个 变量 , 如果是两个变量 , 需要绘制直角坐标系 , 如果是 三个变量 , 需要绘制立体坐标系 ;、
- 局限性：只能处理 2 到 3 个变量的线性规划问题

### 单纯形法

因为图解法具有的局限性，若想同时求取更多变量的线性规划问题，就必须升级方法。

因此，

- 适用范围：求解变量个数大于等于 3 个时，可以使用单纯形法

- 局限性：

  - 对于一般的线性规划问题，我们无法给出**初始基本可行解**，因为这需要满足基本可行解两个条件：
    1. $B$矩阵奇异
    2. 基本解非负

- 本质：单纯形法的本质是求解矩阵方程的求解：

  - 基于标准型的公式：

    $$
    \begin{align}
    \min(\max) \ \ & c^T x \\
    \text{s.t.} \ \ & A x = b \\
    \quad & x \geq 0
    \end{align}
    $$

  - 对矩阵$A$、系数$c$和向量$x$进行分割：

    $$
    A = (B \  N) \\
    c^T = (c_B^T \ c_N^T) \\
    x = (x_B \  x_N)^T
    $$

  - 等式约束条件就变为：$Bx_B+Nx_N=b$，可得：

    $$
    x_B=B^{-1}b-B^{-1}Nx_N
    $$

    带入目标函数：

    $$
    \begin{align}
    z &= c_B^T(B^{-1}b-B^{-1}Nx_N)+c_N^Tx_N \\
       &=c_B^TB^{-1}b-c_B^TB^{-1}Nx_N+c_N^Tx_N \\
       &=c_B^TB^{-1}b+(c_N^T-c_B^TB^{-1}N)x_N
    \end{align}
    $$

  - 因为$x_N \geq 0$，所以要讨论当$x_N \rightarrow + \infty$时$z$值的变化情况，该值受判别系数$\sigma_N =c_N^T-c_B^TB^{-1}N$的影响：

    1. 当$\sigma_N \geq 0$时，$(c_N^T-c_B^TB^{-1}N)x_N \geq 0$，$z \geq c_B^TB^{-1}b$：
       - 最小值为$c_B^TB^{-1}b$，与$x_N$无关，不能用于求解$\min$问题
       - 没有最大值，所以需要一个截止条件，即$\sigma_N \leq 0$，此时可以用于判别$\max$问题
    2. 同理，当$\sigma_N \leq 0$时，没有最小值，需要截止条件$\sigma_N \geq 0$

    > [!NOTE]
    >
    > 关于判别系数为什么是$\sigma_N$而不是$\sigma$？
    >
    > 对照$z=c_B^Tx_B+c_N^Tx_N$，说明$z$是由$x_B$和$x_N$线性组合而成的，那么我们可以写成$z=\sigma_Bx_B+\sigma_Nx_N+C$，此时
    >
    > $$
    > \sigma_B=c_B^T-c_B^TB^{-1}B=0 \\
    > \sigma_N =c_N^T-c_B^TB^{-1}N \\
    > \sigma =c^T-c_B^TB^{-1}A
    > $$

- 进基与出基条件

  - 进基：因为$\sigma_N =c_N^T-c_B^TB^{-1}N$，所以需要将不符合判别系数截止条件的向量进基，如 max 问题需要将$\sigma_N \geq 0$的进基，并且离 0 越远优先级越高；min 问题则需要将$\sigma_N \leq 0$的进基。

  - 离基：当我们确认了进基变量$x_i$后，离基变量$x_j$与它的关系为：

    $$
    \begin{align}
    b&=a_ijx_i+x_j \\
    x_j&=b-a_{ij}x_i
    \end{align}
    $$

    > [!NOTE]
    >
    > $x_i$本来属于$x_N$，而$x_N$是一组从 0 开始增大的数值，并且当符合截止条件时，越是增大，目标函数的损失越大；越是接近 0，目标函数越接近最优解。
    >
    > 但是当$x_i$入基后，会不再是 0，会不可避免地增大，而$x_j$离基后，我们又希望$x_J$小到接近 0；所以我们希望即使$x_i$增大，$x_j$也不会增大太多。

    那么进行分类讨论，讨论当$x_i$增大时，$x_j$的变化情况：

    1. 当$a_{ij} < 0$时，随着$x_i$的增大，$x_j$增大，又因为$x_j \geq 0$，所以要求$x_i \geq 0 >\frac{b}{a_{IJ}}$恒成立，很显然没有这个约束$x_i \geq 0$也是自然成立的。
    2. 当$a_{ij} = 0$时，随着$x_i$的增大，$x_j=b$，又因为$x_j \geq 0$，所以要求$b \geq 0$恒成立。
    3. 当$a_{ij} > 0$时，随着$x_i$的增大，$x_j$减小，又因为$x_j \geq 0$，所以要求$x_i \leq \frac{b}{a_{ij}}$恒成立。

    在 1 的情况下，$x_j$并不能“满足$x_i$增大，$x_j$也不会增大太多”，$x_j$只会无限增大。

    在 2 的情况下，虽然将$x_j$限制为一个定值，但是抑制了$x_j$向 0 靠近的可能性。

    在 3 的情况下，限制了$x_j$的最大值，并且留出了$x_j$向 0 靠近的可能性。

    所以离基条件为

    $$
    a_{ij} > 0且其对应的\theta=\min(\frac{b}{a_{ij}})
    $$

- 截止、进基、离基条件对照表：

  | 线性规划问题类型 | 判别系数截止条件  | 进基条件              | 出基条件                                    |
  | ---------------- | :---------------- | :-------------------- | ------------------------------------------- |
  | $\max$           | $\sigma_N \leq 0$ | $\max(\sigma_N > 0 )$ | $a_{ij} > 0且\theta=\min(\frac{b}{a_{ij}})$ |
  | $\min$           | $\sigma_N \geq 0$ | $\min(\sigma_N < 0)$  | $a_{ij} > 0且\theta=\min(\frac{b}{a_{ij}})$ |

- 单纯形法的计算步骤：
  1. 计算$x_B=B^{-1}b-B^{-1}Nx_N$
  2. 将$x_B$带入判别系数$\sigma_N = c_N^T-c_B^TB^{-1}N$
  3. 将符合进基的非基向量进基，将符合出基条件的基向量离基
  4. 直到符合截止条件

### 单纯形表

单纯形表是对单纯形法的一种可视化迭代，将原本繁琐的计算过程简化为表格呈现。

- 本质：单纯形表的本质是对齐次非方程的求解。

- 求解过程：

  1. 基于标准型：

     $$
     \begin{align}
     \min(\max) \ \ & c^T x \\
     \text{s.t.} \ \ & A x = b \\
     \quad & x \geq 0
     \end{align}
     $$

     将标准型写为：

     $$
     \begin{align}
     z&=c^T x \\
     b &= Ax \\
     \end{align}
     $$

     后根据拆分的基矩阵和基向量，进行改写：

     $$
     \begin{align}
     z&=c_B^Tx_B+c_N^Tx_N \\
     b &= Bx_B+Nx_N \\
     \end{align}
     $$

  2. 进行非齐次矩阵方程组的求解：

     | 原表 | $x_B$   | $x_N$   |
     | ---- | ------- | ------- |
     | $z$  | $c_B^T$ | $c_N^T$ |
     | $b$  | $B$     | $N$     |

     由于矩阵$B$非奇异，所以可以通过矩阵的性质将$B$变为单位矩阵：

     | 表 1      | $x_B$     | $x_N$     |
     | --------- | --------- | --------- |
     | $z$       | $c_B^T$   | $c_N^T$   |
     | $B^{-1}b$ | $B^{-1}B$ | $B^{-1}N$ |

     | 表 2      | $x_B$   | $x_N$     |
     | --------- | ------- | --------- |
     | $z$       | $c_B^T$ | $c_N^T$   |
     | $B^{-1}b$ | $E$     | $B^{-1}N$ |

     接下来需要消去$x_B$，即让$x_B$的系数为 0：

     | 表 3             | $x_B$          | $x_N$                |
     | ---------------- | -------------- | -------------------- |
     | $z-c_B^TB^{-1}b$ | $c_B^T-c_B^TE$ | $c_N^T-c_B^TB^{-1}N$ |
     | $B^{-1}b$        | $E$            | $B^{-1}N$            |

     最终，得到：

     | 最终表           | $x_B$ | $x_N$                |
     | ---------------- | ----- | -------------------- |
     | $z-c_B^TB^{-1}b$ | 0     | $c_N^T-c_B^TB^{-1}N$ |
     | $B^{-1}b$        | $E$   | $B^{-1}N$            |

     数学表达式为

     $$
     \begin{align}
     z&= c_B^TB^{-1}b+(c_N^T-c_B^TB^{-1}N)x_N \\
     B^{-1}b &= x_B+B^{-1}Nx_N \\
     \end{align}
     $$

     与我们之前在数学上推导的表达式一致。

  3. 加以之前的判别系数的截止条件和、进基和离基条件即可。

     | 线性规划问题类型 | 判别系数截止条件  | 进基条件              | 出基条件        |
     | ---------------- | :---------------- | :-------------------- | --------------- |
     | $\max$           | $\sigma_N \leq 0$ | $\max(\sigma_N > 0 )$ | $\max (\theta)$ |
     | $\min$           | $\sigma_N \geq 0$ | $\min(\sigma_N < 0)$  | $\min(\theta)$  |

### 大 M 单纯形法

前面我们提到，单纯形法的缺陷是需要同时满足两个条件：1. 矩阵$B$要满足非奇异；2. 有基本解非负（=有初始基本可行解）。

也就是说，当我们遇到一个线性规划问题，并且即使引入松弛变量后，矩阵$B$依然不能满足如上条件时，此时，我们就要引入**人工变量**，使得矩阵$B$为非奇异矩阵。

这种方法是对单纯形法的一种优化，将单纯形法的缺陷进行弥补。

> [!NOTE]
>
> 此处，我们弥补了单纯形法“矩阵$B$可能不满足非奇异”的缺陷，但是我们并不能确定就有“初始基本可行解”。

- 本质：通过引入一个极大或者极小的值$M$，来对目标函数进行惩罚，使得目标函数的最优解不再依赖于**人工变量**。并且，一旦人工变量离基，就不再参与后续计算。

  > [!IMPORTANT]
  >
  > 那么，为什么一旦人工变量离基，就不再参与后续计算？
  >
  > 根据最优解的表达式：
  >
  > $$
  > z= c_B^TB^{-1}b+(c_N^T-c_B^TB^{-1}N)x_N
  > $$
  >
  > 不管是 max 问题还是 min 问题，都满足当$z \rightarrow z^*$时，$x_N \rightarrow 0$。
  >
  > 所以我们可以认为$z$的最优解$z^*$在极大程度上受$c_B^TB^{-1}b$的影响。在上面单纯形法的离基原理中提到离基的目的是让$b$的值更贴近最优解；但是在进基和离基的时候，变化的还有$c_B^T$，其中包含书的是基变量的系数，包括引入的人工变量的系数$M$。
  >
  > 所以我们希望这个惩罚系数一旦离基就不再参与计算，并且因为能够成功离基，说明此时进基的非基向量能够让后来的基矩阵成立。

- 使用方法：将其带入单纯形法或者单纯形表进行计算即可。

### 二阶段单纯形法

上面说到，大 M 单纯形法弥补了单纯形法矩阵$B$不一定奇异的缺陷，那么二阶段单纯形法弥补的就是单纯形法无法一开始就知道是否存在初始可行解的缺陷。

- 数学模型：同样是引入松弛变量和人工变量，但是此处将其分为两个数学模型（此处以 min 问题为例）：
  含有松弛变量和原变量的模型（二阶段）：

  $$
  \begin{align}
  \min \ \ & c^T x \\
  \text{s.t.} \ \ & A x = b \\
  \quad & x \geq 0
  \end{align}
  $$

  只含有人工变量的模型（一阶段）：

  $$
  \begin{align}
  \min \ \ & e^Ty \\
  \text{s.t.} \ \ & A x+Ey = b \\
  \quad & x,y \geq 0
  \end{align}
  $$

  那么原问题的目标函数就变为：

  $$
  \begin{align}
  \min \ \ & c^T x+e^Ty \\
  \text{s.t.} \ \ & A x+Ey = b \\
  \quad & x,y \geq 0
  \end{align}
  $$

  > [!NOTE]
  >
  > 此处，我们会发现原问题的可行域和新问题的可行域事一样的，所以原问题是否有基本可行解就转换为新问题是否有基本可行解。这样就可以在第一阶段将原问题是否存在基本可行解的问题给优化掉了。

- 从大 M 单纯形法我们知道，他是通过将人工变量的值设为一个极大的惩罚值来退出人工变量的；而二阶段单纯形法则将其系数设为了单位值。
  所以，如果原问题想得到最优解，那么新问题必须也是最优解，此时的最优解就可以作为二阶段的起点进行计算。

- 判断：

  - 若新问题的最优值$w^* \neq 0$，显然，原问题没有最优解
  - 若新问题的最优值$w^* = 0$，那么得到原问题的一个**可行解**，
    - 如果此时辅助线性函数是非退化的，那么此可行解必是原规划的**基本可行解**

## 线性规划的对偶

关于对偶问题和反问题的关系如下：

![image-20251030150255007](/assets/illustrations/image-20251030150255007.png)

### 标准型线性规划的对偶规划

设一个标准型线性规划为：

$$
\begin{align}
\min \ \ & c^T x \\
\text{s.t.} \ \ & A x = b \\
\quad & x \geq 0
\end{align}
$$

其中，$A x = b$可以写为：

$$
A x \leq b 且 A x \geq b
$$

同时，$A x \leq b \rightarrow -Ax \geq -b$，该标准型线性规划就可以写为：

$$
\begin{aligned}
\min \quad c^T x \\
\text{s.t.} \quad Ax &\geq b \\
-Ax &\geq -b \\
x &\geq 0
\end{aligned}
$$

那么可以令：

$$
\overline{A} = \begin{pmatrix} A \\ -A \end{pmatrix}, \overline{b} = \begin{pmatrix} b \\ -b \end{pmatrix}
$$

那么进一步该标准型线性规划可以继续写为：

$$
\begin{aligned}
\min \quad c^T x \\
\text{s.t.} \quad \overline{A}x &\geq \overline{b} \\
x &\geq 0
\end{aligned}
$$

> [!NOTE]
>
> 这里我们可以将$\overline{A}$看作一个$2 \times 1$的矩阵，$x$看作一个$1 \times 1$的矩阵。

其对偶规划为：

$$
\begin{aligned}
\min \quad \overline{b}^T y \\
\text{s.t.} \quad \overline{A}^Ty &\leq c \\
y &\geq 0
\end{aligned}
$$

因为上面我们可以将$\overline{A}$看作一个$2 \times 1$的矩阵，所以$\overline{A}^T$是一个$1 \times 2$的矩阵，那么$y$就应该是一个$2 \times 1$​ 的矩阵，所以我们令：

$$
y=\begin{pmatrix} y_1 \\ y_2 \end{pmatrix}
$$

将$\overline{A}$和$\overline{b}$与其一起代入对偶规划的式子中，得：

$$
\begin{aligned}
\max \quad &b^T y_1 - b^T y_2 \\
s.t. \quad &A^T y_1 - A^T y_2 \leq c \\
&y_1 \geq 0, \, y_2 \geq 0
\end{aligned}
$$

化简为：

$$
\begin{aligned}\max \quad &b^T (y_1 - y_2) \\
\text{s.t.} \quad &A^T (y_1 - y_2) \leq c \\
&y_1 \geq 0, ,y_2 \geq 0\end{aligned}
$$

此时，我们将$y_1-y_2$看作一个$1 \times 1$的矩阵，令$\overline{y}=y_1-y_2$，那么这个对偶规划可以继续写为：

$$
\begin{aligned}\max \quad &b^T \overline{y} \\
\text{s.t.} \quad &A^T \overline{y} \leq c \\
&\overline{y} \geq 0\end{aligned}
$$

$\overline{y}$只是一个符号，所以它等价于使用符号$y$，最终对偶规划就写为：

$$
\begin{aligned}\max \quad &b^T y \\
\text{s.t.} \quad &A^T y \leq c \\
&y \geq 0\end{aligned}
$$

### 弱对偶定理（所有对偶问题共有）

**定义**：设极小化（$\min$）原问题有可行解、其对偶问题（通常为极大化$\max$）也有可行解，若原问题的最优值为$p^*$，对偶问题的最优值为$d^*$，则一定满足$d^* \leq p^*$，这种性质称为**弱对偶（weak duality）**。

由于标准线性规划和其一般形式的线性规划的最优值相同，所以这里假设：

原线性规划（LP）的标准型为：

$$
\begin{align}
\min \ \ f(x)&= c^T x \\
\text{s.t.} \ \  A x &= b \\
\quad  x &\geq 0
\end{align}
$$

根据上面提到的[标准型线性规划的对偶规划](#标准型线性规划的对偶规划)，对偶线性规划（DP）为

$$
\begin{align}
\max \quad  z(y)&=b^T y \\
\text{s.t.} \quad A^T y & \leq c \\
\quad y &\geq 0
\end{align}
$$

根据标准线性规划的等式约束条件式，可以得到：

$$
z(y)=b^Ty=(Ax)^Ty=xA^Ty=x(A^Ty)
$$

> [!NOTE]
>
> 上面我们提到：$x$看作一个$1 \times 1$的矩阵，将$y_1-y_2 \rightarrow y$看作一个$1 \times 1$的矩阵

因为$A^T y \leq c $，所以

$$
z(y)=x(A^Ty) \leq xc=c^Tx
$$

> [!NOTE]
>
> 因为$c$和$x$都被看作$1 \times 1$的矩阵，所以$xc=c^Tx$

即：

$$
z(y) \leq f(x)，对于任意的x,y都成立
$$

所以

$$
\max(z(y)) \leq \min(f(x)) \\
z(y^*) \leq f(x^*)
$$

综上，线性规划问题满足弱对偶性质。

> [!NOTE]
>
> 换句话说，对于两种最优化问题：
>
> 1. min 问题：$d^* \leq p^*$
> 2. max 问题：$d^* \geq p^*$
>
> 并且称两个可行解的函数值的差：$f(x)-z(y)$为对偶间隙。

推论：

1. 一组对偶的线性规划，如果其中任意一个没有**有界的可行解**，那么另一个必不可行。

   > [!NOTE]
   >
   > 假设一个极小化问题，没有有界的可行解，即$p=-\infty$，那么按弱对偶定理，$d \leq p=-\infty$，很显然不成立。
   >
   > 假设一个极小化问题，没有有界的可行解，即$p=+\infty$，那么按弱对偶定理，$d \geq p=+\infty$，很显然不成立。

2. 如果$x^*$和$y^*$分别是原问题和对偶问题的可行解，并且$z(y^*) = f(x^*)$，那么$x^*$和$y^*$都是最优解。

   > [!NOTE]
   >
   > 证明：
   >
   > 由弱对偶性可知：$z(y) \leq f(x)$
   >
   > 所以，$z(y) \leq f(x^*)$，又因为$z(y^*) = f(x^*)$，那么$z(y) \leq z(y^*)$，所以$y^*$是极大化问题$\max \quad z(y)$的最优解。
   >
   > 反之，同理可证$x^*$是极小化问题$\min \quad f(x)$的最优解。

3. 对偶的线性规划都有最优解 $\Leftrightarrow$ 两者都有可行解

### 对偶问题变量的值

依旧使用弱对偶定理（所有对偶问题共有）中提到的线性规划问题。

$$
\begin{align}
\min \ \ f(x)&= c^T x \\
\text{s.t.} \ \  A x &= b \\
\quad  x &\geq 0
\end{align}
$$

在[单纯形法](#单纯形法)中，我们推导出：

$$
f(x)= c_B^TB^{-1}b+(c_N^T-c_B^TB^{-1}N)x_N
$$

此时我们令

$$
y^T=c_B^TB^{-1}
$$

由弱对偶定理的推论，可知：如果对偶问题存在可行解，那么原问题也应存在可行解。

原问题存在可行解的条件是判别数$\sigma_N \geq 0$，即$c_N^T-c_B^TB^{-1}N \geq 0$，得到

$$
c_N^T \geq c_B^TB^{-1}N  \\
c_N^T \geq y^TN
$$

对于$y^TB$，则

$$
y^TB=c_B^TB^{-1}B=c_B^T
$$

所以

$$
y^TB=c_B^T \\
y^TN \leq c_N^T
$$

将其写为矩阵形式

$$
y^T \begin{bmatrix} B \\ N \end{bmatrix} \leq \begin{bmatrix} c_B^T \\ c_N^T \end{bmatrix} \\
y^TA \leq c^T \\
A^Ty \leq c
$$

与上面推导的对偶规划对比：

$$
\begin{aligned}\max \quad &b^T y \\
\text{s.t.} \quad &A^T y \leq c \\
&y \geq 0\end{aligned}
$$

我们会发现完全符合条件。

所以实际上$y^T=c_B^TB^{-1}$

从这里我们可以得到一个结论，如果一个线性规划问题的判别数符合截止条件，那么其对偶规划必有可行解，且$y^T=c_B^TB^{-1}$，他们的关系为

$$
\sigma_N=c_N^T-y^TN
$$

所以，若已知判别数，那么可以求得对偶可行解$y^T$

并且求取对偶函数的目标函数$b^Ty$：

$$
b^Ty=y^Tb=c_B^TB^{-1}b
$$

其值为原线性规划函数的固定值部分，符合：$c^Tx \geq b^Ty$，即符合弱对偶定理。

### 强对偶定理（在线性规划中）

**定义**：互为对偶的两个线性规划问题，若其中一个有最优解，则另一个必也有最优解，且两者的最优目标函数值相等（$f(x^*)=z(y^*)$）。

> [!CAUTION]
>
> 注意描述！
>
> 弱对偶是假设了两个对偶的线性规划具有最优解，这两个最优解直接并无直接联系，然后才推导出大小关系。
>
> 而强对偶关系是只假设了一个线性规划具有最优解，直接就给出最优目标函数值相等的结论。
>
> 关键在于最初的假设中，两个对偶的线性规划的最优解是否是共生的依赖关系。

| 维度     | 强对偶性（线性规划专属）                     | 弱对偶性（所有对偶问题通用）                          |
| -------- | -------------------------------------------- | ----------------------------------------------------- |
| 核心逻辑 | 一个有**最优解** → 另一个有最优解+最优值相等 | 两者有**可行解** → 原问题目标值 $\geq$ 对偶问题目标值 |
| 前提条件 | 仅需“一个问题有最优解”                       | 仅需“两者都有可行解”                                  |
| 核心结论 | 最优解共生+最优值相等                        | 目标值有不等式约束（对偶间隙 ≥0）                     |
| 关键特性 | 是线性规划的专属性质（需满足线性结构）       | 是对偶问题的通用性质（不限线性/非线性）               |

定理证明：

同样以极小化问题举例，同样考虑到标准型和一般型的最优目标函数值相同，所以依旧以标准型线性规划及其对偶规划举例：

（LP）标准型：

$$
\begin{align}
\min \ \ f(x)&= c^T x \\
\text{s.t.} \ \  A x &= b \\
\quad  x &\geq 0
\end{align}
$$

根据定义，假设该线性规划的最优解$x^*$，那么根据等式约束，可以解得原极小化问题的目标函数值为：

$$
f(x^*)=c_B^TB^{-1}b+(c_N-c_B^TB^{-1}N)x_N^*
$$

判别数$\sigma \geq 0$，即

$$
\sigma_N=c_N^T-c_B^TB^{-1}N \geq 0
$$

所以当考虑所有的情况，最理想的状态并且最有代表性的状态就是$x_N^*=0$，即$x^*$为基本可行解。

此时的最优目标函数值为：

$$
f(x^*)=c_B^TB^{-1}b
$$

在[上面](#对偶问题变量的值)我们知道对偶问题中变量$y^*$的值其实是$y^T=c_B^TB^{-1}$，则计算对偶规划的需满足：

$$
\sigma=c^T-y^TA \geq 0 \\
得 \quad A^Ty \leq c
$$

（DP）对偶问题的一般型表达式为：

$$
\begin{aligned}\max \quad &b^T y \\
\text{s.t.} \quad &A^T y \leq c \\
&y \geq 0\end{aligned}
$$

符合上面计算得到得条件。那么对偶规划的最优目标函数值应该为：

$$
z(y^*)=b^T(c_B^TB^{-1})^T=c_B^TB^{-1}b
$$

得到

$$
f(x^*)=z(y^*)
$$

得证。

### 对偶的线性规划的解的情况

当我们把弱对偶定理和强对偶定理拿出来进行对比，我们会发现他们的解会出现以下几种情况：

| 可行解情况     | 最优解情况                                                       | 与对偶定理的关联                                                                            |
| -------------- | ---------------------------------------------------------------- | ------------------------------------------------------------------------------------------- |
| 两者都有可行解 | 1. 都有最优解（强对偶+弱对偶） <br>2. 只有一个有最优解（弱对偶） | 1. 满足弱对偶（通用性质）：$p^* \geq d^* $<br>2. 满足强对偶（线性规划专属）：$ p^* = d^* $ |
| 两者都无可行解 | 均无最优解                                                       | \                                                                                           |
| 仅一个有可行解 | 有可行解的一方必**无界**（弱对偶）                               | 弱对偶定理的推论                                                                            |

## 整数线性规划

整数规划分为两种：

1. 纯整数线性规划
2. 混合型整数线性规划

### 割平面法

参考文档：[求解整数规划问题的割平面法和分支定界法 - 知乎](https://zhuanlan.zhihu.com/p/652678113)

在该文档中，讲到割平面法的本质是给松弛问题（标准型线性规划），加一个**约束条件**，从而达到将非整数的部分切去的目的。

其中的解题基础还是单纯形法，最重要的核心的是如何获取这个约束条件。

举一个例子：

$$
\begin{align}
\min \quad -x_1-x_2 \\
\text{s.t.} \quad 2x_1+x_2 & \leq 6 \\
\quad  4x_1+5x_2 & \leq 20 \\
\quad x_1,x_2 & \geq 0,且为整数
\end{align}
$$

使用单纯形法进行计算，最终的单纯形表为：

|       |       |     | $x_1$ | $x_2$ | $x_3$ | $x_4$ |
| ----- | ----- | --- | ----- | ----- | ----- | ----- |
| $c_B$ | $B$   | $b$ | 0     | -1/2  | 1/2   | 0     |
| -1    | $x_1$ | 5/3 | 1     | 0     | 5/6   | -1/6  |
| -1    | $x_2$ | 8/3 | 0     | 1     | -2/3  | 1/3   |
|       |       |     | 0     | 0     | 1/6   | 1/6   |

任取一行，如$x_2$行：

$$
0 \cdot x_1 +1 \cdot x_2 -\frac{2}{3} \cdot x_3 +\frac{1}{3} \cdot x_4=\frac{8}{3}
$$

因为：

- 任意一个数都可以写为整数部分+小数部分
- 正整数要么为 0，要么是一个大于 1 的数，不可能为一个小数
- $x_i$为整数，如果系数为整数那么乘积为整数

所以可以将上式分为两个部分，即整数部分和小数部分：

$$
(0+0) \cdot x_1 +(1+0) \cdot x_2 -(1-\frac{1}{3}) \cdot x_3 +(0+\frac{1}{3}) \cdot x_4=2+\frac{2}{3} \\
\left(0x_1 + 1x_2 - 1x_3 + 0x_4 - 2\right) +( \frac{1}{3}x_3 + \frac{1}{3}x_4)= \frac{2}{3}
$$

> [!NOTE]
>
> 最好让系数的小数部分同时为正或者同时为负。

已知等式左边第一项一定为整数，当其大于 0 时一定大于 1，又因为第二项为正，那么等式左边一定是一个大于等于 1 的数，等式不成立；所以第一项为一个小于等于 0 的整数，那么等式右边减第二项小于等于 0，即

$$
\frac{2}{3}- \frac{1}{3}x_3 - \frac{1}{3}x_4 \leq 0
$$

得约束式：

$$
-x_3-x_4+x_5 = -2
$$

带入单纯形表：

|       |       |     | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ |
| ----- | ----- | --- | ----- | ----- | ----- | ----- | ----- |
| $c_B$ | $B$   | $b$ | -1    | -1    | 0     | 0     | 0     |
| -1    | $x_1$ | 5/3 | 1     | 0     | 5/6   | -1/6  | 0     |
| -1    | $x_2$ | 8/3 | 0     | 1     | -2/3  | 1/3   | 0     |
| 0     | $x_5$ | -2  | 0     | 0     | -1    | -1    | 1     |
|       |       |     | 0     | 0     | 1/6   | 1/6   | 0     |

此时该解已经优化为整数解。

### 分枝界定法

分支界定法是将一个线性规划问题的解进行范围限定。

假设一个线性规划问题的解为$x$，其中的一个分量为$x_r=N_r + f_r$，其中$N_r=[x_r]$为整数，那么该分量必定满足大小关系：$N_r \leq x_r \leq N_r+1$

也就是说想让$x_r$取到整数，在已经满足如上不等式的情况下，$x_r$需满足两种条件的一种：

1. $x_r \geq N_r$
2. $x_r \leq N_r +1$

所以根据上面的两个条件将一个线性规划问题转换为两个问题：

$$
\begin{align}
\min \ \ c^T x \\
\text{s.t.} \ \  A x &= b \\
\quad x_r &\leq N_r \\
\quad  x &\geq 0
\end{align}
$$

$$
\begin{align}
\min \ \ c^T x \\
\text{s.t.} \ \  A x &= b \\
\quad x_r &\geq N_r+1 \\
\quad  x &\geq 0
\end{align}
$$

解题时，先使用单纯形法计算最优解，如果为整数，则为最优解；不为整数则将其划分为两个线性规划问题进行计算。

举例：

![线性规划对偶解情况示意图](/assets/illustrations/image-20251103135540044.png)

![image-20251103135553658](/assets/illustrations/image-20251103135553658.png)

![image-20251103135624506](/assets/illustrations/image-20251103135624506.png)

![image-20251103135641536](/assets/illustrations/image-20251103135641536.png)
